<!doctype html>
<head>
    <link href="dist/output.css" rel="stylesheet"></script>
    <link href="https://rsms.me/inter/inter.css" rel="stylesheet"></script>
    <script src="https://code.iconify.design/2/2.2.1/iconify.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


</head>
<body class="bg-white flex flex-col   ">
  <div id="formie">
    <div class=" px-3 sm:px-4 bg-purple-500 flex flex-row content-center items-center"><h1 class="text-white font-medium sm:font-semibold sm:text-xl">Upload</h1>
      <button onclick="window.location.replace('forms.html')" class="outline-none font-medium text-white ml-auto mr-2 border-1 border-white   p-2 py-[6px] m-2 px-4"><- Back</button>
      <button onclick="logout()" class="outline-none font-medium text-white ml-2 mr-2 border border-white   p-2 py-[6px] m-2 px-4">Logout</button>
    </div>
    <div class="mx-auto my-auto flex flex-col p-2 px-8 ">

        <form class="flex flex-col "> 
            
<div class="my-3">
              <label for="folder " class="mr-3 text-sm font-semibold bg-blue-50 text-blue-700 rounded-full px-4 py-2">Choose a folder</label>

<select name="folder" id="folder">
  <option value="Assembly">Assembly</option>
  <option value="QC">QC</option>
  <option value="Activities">Activities</option>
  
</select>
</div>
<label class="block mb-3">
    <span class="sr-only ">Choose File</span>
    <input type="file" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" id="files"/>
  </label>
<button id="send"  class="w-full shadow bg-purple-500 hover:bg-purple-400 focus:shadow-outline focus:outline-none text-white font-bold py-2 px-4 rounded" type="button">
    Upload
  </button>

              
            
          </form> 
     
    </div>

  </div>
      <div id="notlogged">
          Not Logged In. Access Denied
      </div>
      <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-app-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-database-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-auth-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-storage-compat.js"></script>
      <script>
           const firebaseConfig = {
      apiKey: "AIzaSyB4BuDJvPnZG5FS51jAfuOGnnXGyyFwvfY",
      authDomain: "auformproject.firebaseapp.com",
      databaseURL: "https://auformproject-default-rtdb.firebaseio.com",
      projectId: "auformproject",
      storageBucket: "auformproject.appspot.com",
      messagingSenderId: "466460203182",
      appId: "1:466460203182:web:c26f232654d7a18fc6b53f"
    };
  
    const firebaseApp = firebase.initializeApp(firebaseConfig);
   const db = firebaseApp.database();

   var storageRef = firebase.storage().ref();

    
   const auth = firebaseApp.auth();
   auth.onAuthStateChanged(i => {
  if (!i) {
      document.getElementById('formie').classList.add('hidden');
      document.getElementById('notlogged').classList.remove('hidden');

  } else {
    document.getElementById('formie').classList.remove('hidden');
    document.getElementById('notlogged').classList.add('hidden');
  }
});

function logout(){
    firebase.auth().signOut();
    window.location.replace('index.html')
}

var files = [];
document.getElementById("files").addEventListener("change", function(e) {
files = e.target.files;
});

document.getElementById("send").addEventListener("click", function() {
      if (files.length != 0) {

      for (let i = 0; i < files.length; i++) {

        var storage = firebase.storage().ref(document.getElementById("folder").value+'/'+files[i].name);

        var upload = storage.put(files[i]);

        upload.on(
          "state_changed",
          function progress(snapshot) {
            var percentage =
              (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
          },

          function error() {
            alert("error uploading file");
          },

          function complete() {
            alert('uploaded')
          }
        );
      }
      } else {
      alert("No file chosen");
      }
      });
          </script>

</body>